опишите требования к безопасности,
выделите протоколы аутентификации и авторизации,
опишите, как будет организовано взаимодействие между системами предприятия и внешней платформой.


# Требования к безопасности.

## Идентификация и аутентификация

- Использовать уникальные учетные записи для каждого пользователя
- Поддерживать многофакторную аутентификацию (MFA) (например, пароль + биометрия или код из SMS)
- Обеспечить возможность сброса пароля с проверкой через подтвержденные контакты (e-mail/SMS).
- Применять защиту от брутфорс-атак 

## Авторизация

- Разделить права доступа к функциям системы, чтобы пользователи могли выполнять только разрешенные им действия 
(например, доступ к конкретному шлагбауму или домофону).
- Использовать токены с ограниченным временем жизни (например, OAuth 2.0 JWT) для управления сессиями

## Шифрование данных

- Использовать TLS для передачи данных между приложениями, шлагбаумами и домофонами
- Хранить данные пользователя в зашифрованном виде на сервере
- Обеспечить шифрование конфиденциальных данных, передаваемых 
между мобильным приложением и устройствами (например, команд на открытие/закрытие).

## Управление сессиями

- Реализовать автоматический выход из системы после определенного периода бездействия
- Поддерживать возможность отзыва токена сессии пользователем (например, если устройство утеряно).

## Устойчивость к атакам

- Использовать механизмы для предотвращения Replay-атак (например, нумерация сообщений или временные метки).
- Проверять входящие данные на соответствие ожиданиям (например, для предотвращения SQL-инъекций или XSS).

## Интеграция с устройствами третьей стороны

- Проверить безопасность API и протоколов, используемых шлагбаумами и домофонами, предоставленными сторонними производителями
- Ограничить функциональность внешних устройств минимально необходимой (принцип минимальных привилегий).
- Защитить ключи и сертификаты, используемые для взаимодействия с устройствами


## Логирование и мониторинг

- Логировать все значимые действия пользователей (входы, открытия шлагбаумов/дверей, изменения настроек).
- Обеспечить защиту логов от изменения и их анализ в режиме реального времени для обнаружения подозрительной активности
- Реализовать механизм уведомления о подозрительных событиях (например, попытка взлома)

## Конфиденциальность и соответствие требованиям

- Хранить и обрабатывать персональные данные в соответствии с законами о защите данных
- Минимизировать объем собираемых данных
- Обеспечить информирование пользователей о сборе, обработке и использовании их данных

## Планирование отказоустойчивости

- Реализовать резервное копирование критичных данных и их безопасное хранение
- Подготовить процедуры восстановления после инцидентов


#  Протоколы аутентификации и авторизации,

## Аутентификация

- Для аутентификации используется OpenID Connect (OIDC). В результате используется access token, содержащий доступы пользователя к ресурсам.


## Авторизация

- Для авторизации запросов используется протокол OIDC с JWT access token-ом.

Взаимодействие с API сервиса, предоставляющего достук устройствам необходимо использовать  
шифрованные каналы передачи данных. Тело сообщения, которое отправляется на сторонние сервисы должно быть подписано,
и по возможности, зашифровано.

# Организация взаимодействие между системами предприятия и внешней платформой.

## Поток данных

- Пользователь проходит аутентификацию в мобильном приложении.
- Пользователь запрашивает доступные ему для управления шалгбаумы/домофоны
- Пользователь выбирает доступный шлагбаум/домофон.
- Пользователь получает текущее состояние выбранного устройства.
- Пользователь отправляет команду 
- Сервисы проверяют авторизацию на выполнение команды и отправляют на устройство либо оповещают об отсутствии доступа.
- Система логирует результат выполнения операции